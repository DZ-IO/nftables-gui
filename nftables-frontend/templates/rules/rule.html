{% extends "base.html" %}
{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/rule.css') }}">
{% endblock %}
{% block content %}
<div class="container">
    <h1>Rule</h1>
    <div>
        <h2>Handle: {{ rule.handle }}</h2>
        <h2>Family: {{ rule.family }}</h2>
        <h2>Table: {{ rule.table().name }}</h2>
        <h2>Chain: {{ rule.chain.name }}</h2>
        <h2>Description: {{ rule.description }}</h2>
    </div>
    </div>
    <h1>Statements</h1>
        <table class="table personal-table">
                <thead>
                  <tr>
                    <th>id</th>
                    <th>rule_id</th>
                    <th>description</th>
                    <th>src_ip</th>
                    <th>dst_ip</th>
                    <th>src_port</th>
                    <th>dst_port</th>
                    <th>protocol</th>
                    <th>reject</th>
                    <th>drop</th>
                    <th>accept</th>
                    <th>queue</th>
                    <th>return_</th>
                    <th>jump</th>
                    <th>go_to</th>
                    <th>limit</th>
                    <th>log</th>
                    <th>counter</th>
                    <th>nflog</th>
                    <th>masquerade</th>
                    <th>snat</th>
                    <th>dnat</th>
                    <th>redirect</th>
                  </tr>
                </thead>
                <tbody>
                  
                    {% for statement in statements %}
                    <tr>
                    <td>{{ statement.id }}</td>
                    <td>{{ statement.rule_id }}</td>
                    {% if statement.description != None %}
                    <td>{{ statement.description }}</td>
                    {% else %}
                    <td>No description</td>
                    {% endif %}
                    {% if statement.src_ip != None %}
                    <td>{{ statement.src_ip }}</td>
                    {% else %}
                    <td>No source IP</td>
                    {% endif %}
                    {% if statement.dst_ip != None %}
                    <td>{{ statement.dst_ip }}</td>
                    {% else %}
                    <td>No destination IP</td>
                    {% endif %}
                    {% if statement.src_port != None %}
                    <td>{{ statement.src_port }}</td>
                    {% else %}
                    <td>No source port</td>
                    {% endif %}
                    {% if statement.dst_port != None %}
                    <td>{{ statement.dst_port }}</td>
                    {% else %}
                    <td>No destination port</td>
                    {% endif %}
                    {% if statement.protocol != None %}
                    <td>{{ statement.protocol }}</td>
                    {% else %}
                    <td>No protocol</td>
                    {% endif %}
                    <td>{{ statement.reject or "" }}</td>
                    <td>{{ statement.drop or "" }}</td>
                    <td>{{ statement.accept or "" }}</td>
                    <td>{{ statement.queue or ""}}</td>
                    <td>{{ statement.return_  or ""}}</td>
                    <td>{{ statement.jump or ""}}</td>
                    <td>{{ statement.go_to or "" }}</td>
                    <td>{{ statement.limit or ""}}</td>
                    <td>{{ statement.log or ""}}</td>
                    <td>{{ statement.counter or "" }}</td>
                    <td>{{ statement.nflog or "" }}</td>
                    <td>{{ statement.masquerade or "" }}</td>
                    <td>{{ statement.snat or "" }}</td>
                    <td>{{ statement.dnat or ""}}</td>
                    <td>{{ statement.redirect or ""}}</td>
                  </tr>

                    {% endfor %}
                </tbody>
              </table>
{% endblock %}              